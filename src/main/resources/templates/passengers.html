<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Список пассажиров Титаника</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container">
    <h1 class="mt-4">Список пассажиров Титаника</h1>

    <!-- Форма для фильтрации -->
    <form th:action="@{/passengers}" method="get" class="mb-4">
        <div class="form-row">
            <div class="form-group col-md-3">
                <label for="name">Имя</label>
                <input type="text" class="form-control" id="name" name="searchName" placeholder="Введите имя">
            </div>
            <div class="form-group col-md-3">
                <label for="survived">Выживший</label>
                <select class="form-control" id="survived" name="survived">
                    <option value="">Все</option>
                    <option value="true">Да</option>
                    <option value="false">Нет</option>
                </select>
            </div>
            <div class="form-group col-md-3">
                <label for="age">Возраст старше</label>
                <input type="number" class="form-control" id="age" name="age" placeholder="Введите возраст">
            </div>
            <div class="form-group col-md-3">
                <label for="gender">Пол</label>
                <select class="form-control" id="gender" name="gender">
                    <option value="">Все</option>
                    <option value="male">Мужской</option>
                    <option value="female">Женский</option>
                </select>
            </div>
            <div class="form-group col-md-3">
                <label for="hasRelatives">Без родственников</label>
                <select class="form-control" id="hasRelatives" name="noRelatives">
                    <option value="">Все</option>
                    <option value="true">Да</option>
                    <option value="false">Нет</option>
                </select>
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Фильтровать</button>
    </form>

    <!-- Кнопка для фильтрации совершеннолетних пассажиров -->
    <form th:action="@{/passengers}" method="get" class="mb-4">
        <input type="hidden" name="adult" value="1" /> <!-- Установлено значение 1 для фильтрации по возрасту -->
        <button type="submit" class="btn btn-secondary">Показать всех совершеннолетних пассажиров</button>
    </form>

    <!-- Таблица для отображения пассажиров -->
    <table class="table table-striped">
        <thead>
        <tr>
            <th th:onclick="'sortByName()'">Имя</th>
            <th th:onclick="'sortByAge()'">Возраст</th>
            <th th:onclick="'sortByFare()'">Оплата</th>
            <th>Выживший</th>
            <th>Пол</th>
            <th>Родственники</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="passenger : ${passengers}">
            <td th:text="${passenger.name}"></td>
            <td th:text="${passenger.age}"></td>
            <td th:text="${passenger.fare}"></td>
            <td th:text="${passenger.survived ? 'Да' : 'Нет'}"></td>
            <td th:text="${passenger.gender}"></td>
            <td th:text="${passenger.siblingsSpousesAboard + passenger.parentsChildrenAboard}"></td>
        </tr>
        </tbody>
    </table>

    <!-- Статистика -->
    <div class="mt-4">
        <h3>Статистика</h3>
        <p>Общая сумма оплаты: <span th:text="${statistics.totalFare}"></span></p>
        <p>Количество выживших: <span th:text="${statistics.survivorsCount}"></span></p>
        <p>Количество людей с родственниками: <span th:text="${statistics.relativesCount}"></span></p>
    </div>

    <!-- Пагинация -->
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <li class="page-item" th:class="${currentPage == 0} ? 'disabled'">
                <a class="page-link" th:href="@{/passengers(page=${currentPage - 1}, size=${pageSize}, searchName=${searchName}, survived=${survived}, adult=${adult}, gender=${gender}, noRelatives=${noRelatives})}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item" th:each="page : ${#numbers.sequence(0, totalPages - 1)}" th:class="${page == currentPage} ? 'active'">
                <a class="page-link" th:href="@{/passengers(page=${page}, size=${pageSize}, searchName=${searchName}, survived=${survived}, adult=${adult}, gender=${gender}, noRelatives=${noRelatives})}" th:text="${page + 1}"></a>
            </li>
            <li class="page-item" th:class="${currentPage == totalPages - 1} ? 'disabled'">
                <a class="page-link" th:href="@{/passengers(page=${currentPage + 1}, size=${pageSize}, searchName=${searchName}, survived=${survived}, adult=${adult}, gender=${gender}, noRelatives=${noRelatives})}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
</body>
</html>

